pipeline {
    agent any
    stages {
        stage('Build and Test') {
            steps {
                sh './run.sh build_test'
            }
        }
        stage('Save artifacts') {
            steps {
                sh 'mkdir artifacts'
                sh 'cp my-all-in-one-platform-jar/target/my-all-in-one-platform-jar-1.0-SNAPSHOT.jar artifacts/'
                sh 'cp my-all-in-one-share-jar/target/my-all-in-one-share-jar-1.0-SNAPSHOT.jar artifacts/'
            }
        }
        stage('Clean up') {
            steps {
                sh 'mvn clean'
            }
        }
    }
}
